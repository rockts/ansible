---

- name: ansible playbook
  hosts: '{{ hosts }}'
  remote_user: vagrant
  become: yes
  vars:
    user_name: 'rockts'
    hosts: all
  tasks:
    - include: test.yml
    - name: ssh key auth
      authorized_key:
        user: vagrant
        key: "{{ lookup('file', '/root/.ssh/id_rsa.pub') }}"
        state: present
    - name: Install epel repos
      yum:
        name: epel-release
        state: latest
    - name: Common tool
      yum:
        name: '{{ item.name }}'
        state: '{{ item.state }}'
      with_items:
        - { name: tree, state: latest }
        - { name: zip, state: latest }
      tags:
        - common
    - name: Add User
      user:
        name: '{{ user_name }}'
        state: present
        groups: wheel
        append: yes
        password: '$6$rounds=656000$qXsT6YIlIs5R5OGm$rNOor0eMQGbqsE6yt4OAbwJkV.WrWlmmEXvSxkxbxemsuZriY2eELdYMiR9reyL.fnWE5nRTV8oreQwKCI0s0/'
      tags:
        - user
  roles:
    - docker
